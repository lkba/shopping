<!DOCTYPE html>
<html xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="../../t_css/bootstrap.css"/>
    <link rel="stylesheet" href="../../t_css/layout.css"/>
    <link rel="stylesheet" type="text/css" href="../../t_css/teacher.css"/>
    <script type="text/javascript" src="../../t_js/jquery.min.js"></script>
    <script type="text/javascript" src="../../t_js/bootstrap.min.js"></script>

    <script src="../../t_js/jquery.js"></script>
    <script src="../../t_js/layer.js"></script>
    <script src="../../t_js/teacher.js"></script>

<!--	<link rel="stylesheet" href="../../t_css/bootstrap.css" />-->
<!--	<link rel="stylesheet" href="../../t_css/layout.css" />-->
<!--	<link rel="stylesheet" type="text/css" href="../../t_css/student.css"/>-->
<!--	<script src="../../t_js/jquery.js"></script>-->
<!--	<script src="../../t_js/layer.js"></script>-->
	<script src="../../t_js/jquery.jqprint-0.3.js"></script>
	<link href="../../t_css/print3.css" rel="stylesheet" type="text/css" >
<!--	<script type="text/javascript" src="../../t_js/bootstrap.min.js" ></script>-->
    <title></title>
    <script>

    </script>
    <style>
        body {
            padding: 20px 0;
        }

        label {
            margin: 0 72px 0 10px;
            display: inline-block;
            vertical-align: middle;
        }

        input[type="radio"] {
            vertical-align: middle;
            margin: 0;
        }

        td {
            vertical-align: middle !important;
            text-align: left;
        }

        table th {
            vertical-align: middle !important;
            text-align: center;
            min-width: 113px;
        }

        textarea {
            resize: none;
            word-wrap: break-word;
            background: none;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        /*样式1*/
        .a-upload {
            padding: 4px 10px;
            height: 100%;
            line-height: 20px;
            position: relative;
            cursor: pointer;
            color: #888;
            background: #fafafa;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            display: inline-block;
            *display: inline;
            *zoom: 1
        }

        .a-upload input {
            position: absolute;
            font-size: 100px;
            right: 0;
            top: 0;
            opacity: 0;
            filter: alpha(opacity=0);
            cursor: pointer
        }

        .a-upload:hover {
            color: #444;
            background: #eee;
            border-color: #ccc;
            text-decoration: none
        }
    </style>
</head>
<body>
<div class="bodyer" id="app">
    <div id="print-area">
        <center><h1>创新创业学院创业孵化基地团队入驻表</h1></center>
        <form onsubmit="return dosubmit()" v-for="basic in basics">
            <table class="table table-bordered">
                <tr>
                    <th colspan="1">团队名称</th>
                    <td colspan="7">{{basic.team}}</td>
                </tr>
                <tr>
                    <th colspan="1">项目名称</th>
                    <td colspan="7">{{basic.project}}</td>
                </tr>
                <tr>
                    <th colspan="1">公司是否注册</th>
                    <td colspan="1" id="registered">{{basic.registered}}</td>
                    <th colspan="1">注册时间</th>
                    <td colspan="2" id="reg_time">
                        {{basic.regTime}}

                    </td>
                    <th colspan="1">注册资金<br>（万元）</th>
                    <td colspan="2" id="money">{{basic.money}}</td>
                </tr>
                <tr>
                    <th colspan="1">经营范围<br>（产品/服务）</th>
                    <td colspan="7">{{basic.businessScope}}</td>
                </tr>
                <tr>
                    <th>行业类别</th>
                    <td colspan="7">
                        {{basic.class_por}}
                    </td>
                </tr>
                <template v-for="(teacher, key ,index)  in teachers">
                    <tr>
                        <th id="th1" :rowspan="len" colspan="1" v-if="key<=0">项目指导教师</th>
                        <!--                <foreach name="teacher" item="v">-->
                        <th colspan="1">姓名</th>
                        <td colspan="2">{{teacher.name}}</td>
                        <th colspan="2">系别</th>
                        <td colspan="2">{{teacher.department}}</td>
                    </tr>
                    <tr>
                        <th colspan="1">职务</th>
                        <td colspan="2">{{teacher.position}}</td>
                        <th colspan="2">负责领域</th>
                        <td colspan="2">{{teacher.field}}</td>
                    <tr>
                        <!--                </foreach>-->
                </template>
                <tr>
                    <th rowspan="3" colspan="1">项目主创<br>团队人员<br>基本情况</th>
                    <th colspan="1">负责人</th>
                    <td colspan="2">{{user.name}}</td>
                    <th colspan="1">年龄</th>
                    <td colspan="1" style="width: 180px;">{{user.age}}</td>
                    <th colspan="1">性别</th>
                    <td colspan="1">{{user.sex}}</td>
                </tr>
                <tr>
                    <th colspan="1">系别</th>
                    <td colspan="2">{{user.department}}</td>
                    <th colspan="2">专业班级</th>
                    <td colspan="2">{{user.professional}}</td>
                </tr>
                <tr>
                    <th colspan="1">手机号码</th>
                    <td colspan="2">{{user.phone}}</td>
                    <th colspan="2">E-mail/QQ</th>
                    <td colspan="2">{{user.email}}</td>
                </tr>

                <tr>
                    <th :rowspan="len2" colspan="1">核心团队成员信息（不超9个）</th>
                    <th colspan="1">姓名</th>
                    <th colspan="1">性别</th>
                    <th colspan="1">系别</th>
                    <th colspan="2">专业班级</th>
                    <th colspan="1">手机号码</th>
                    <th colspan="1">E-mail/QQ</th>
                </tr>
                <!--            <foreach name="team" item="vv">-->
                <tr v-for="vv in team">
                    <td colspan="1">{{vv.name}}</td>
                    <td colspan="1">{{vv.sex}}</td>
                    <td colspan="1">{{vv.department}}</td>
                    <td colspan="2">{{vv.professional}}</td>
                    <td colspan="1">{{vv.phone}}</td>
                    <td colspan="1">{{vv.email}}</td>
                </tr>
                <!--            </foreach>-->
                <tr>
                    <th colspan="1" rowspan="4">项目规模</th>
                </tr>
                <tr>
                    <td colspan="1">启动资金</td>
                    <td colspan="6">{{enter.money}}</td>
                </tr>
                <tr>
                    <td colspan="1">办公场地</td>
                    <td colspan="6">{{enter.areawork}}</td>
                </tr>
                <tr>
                    <td colspan="1">员工人数
                    </th>
                    <td colspan="6">{{enter.persons}}</td>
                </tr>


                <tr>
                    <th colspan="1">企业形式</th>
                    <td colspan="7">
                        {{enter.form}}
                    </td>
                </tr>
                <tr>
                    <th colspan="1">
                        项目基本思路（可附思维导图）
                    </th>
                    <td colspan="7">{{enter.thinking}}</td>
                </tr>

                <tr>
                    <th colspan="1">
                        项目预期效果（包括社会效益和经济效益）
                    </th>
                    <td colspan="7">{{enter.effect}}</td>
                </tr>
                <tr>
                    <th colspan="1">
                        项目简介（300字以内）
                    </th>
                    <td colspan="7">{{enter.abstracts}}</td>
                </tr>

                <tr>
                    <th colspan="1">
                        项目特色（200字以内）
                    </th>
                    <td colspan="7">{{enter.characters}}</td>
                </tr>

                <tr>
                    <th colspan="1">
                        项目可行性简述（技术保障、市场容量、团队能力支持、资金来源、发展方向，600字以内）
                    </th>
                    <td colspan="7">{{enter.feasibility}}</td>
                </tr>

                <tr>
                    <th colspan="1">
                        其他说明（300字以内）
                    </th>
                    <td colspan="7">{{enter.explains}}</td>
                </tr>

                <tr>
                    <th colspan="1">创业计划书</th>
                    <td colspan="7">
                        <a :href="enter.prospectus" class="a-upload">下载文件</a>
                    </td>
                </tr>

                <tr height="150px">
                    <th colspan="1">
                        创业团队负责人所在系意见（系党总支盖章）
                    </th>
                    <td colspan="7" style="position: relative;">
                        {{enter.department_idea}}
                        <div style="position: absolute;bottom: 30px;right: 100px;">（盖章）</div>
                        <div style="position: absolute;bottom: 5px;right: 50px;">&nbsp;&nbsp;&nbsp;&nbsp;年&nbsp;&nbsp;&nbsp;&nbsp;月&nbsp;&nbsp;&nbsp;&nbsp;日</div>
                    </td>
                </tr>
            </table>
            <div>
                备注： 申请表和商业计划书需上交打印稿和电子稿，申请表和创业计划书分开装订，A4纸双面打印，于左侧双颗钉装订成册，各一份。
            </div>
            <button type="button" class="btn btn-info" style="float: right;margin-left: 20px;margin-bottom: 50px;"
                    onclick="back()">返回
            </button>
            <button v-if="user.isSub!=1" type="button" class="btn btn-info"
                    style="float: right;margin-left: 20px;margin-bottom: 50px;" v-on:click="subTable()">提交
            </button>
            <button v-if="user.isPass==1" type="button" class="btn btn-info"
                    style="float: right;margin-left: 20px;margin-bottom: 50px;">已通过
            </button>
            <button v-else type="button" class="btn btn-info"
                    style="float: right;margin-left: 20px;margin-bottom: 50px;">待审核
            </button>
            <button type="button" class="btn btn-info" style="float: right;margin-left: 20px;margin-bottom: 50px;"
                    onclick="print()">打印
            </button>

        </form>
    </div>
</div>
</body>
</html>
<script>
    function back() {
        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        parent.layer.close(index); //再执行关闭
    }

    $(function () {
        if ($('#registered').text() == '否') {
            $('#reg_time').text('无');
            $('#money').text('无');
        }

//        $("form").submit(function(e){
//            if($('#time').value()==""){
//                $('#time').focus();
//                return false;
//            }
//        });

    });

    var isCommitted = false;//表单是否已经提交标识，默认为false
    function dosubmit() {
        if (isCommitted == false) {
            isCommitted = true;//提交表单后，将表单是否已经提交标识设置为true
            return true;//返回true让表单正常提交
        } else {
            return false;//返回false那么表单将不提交
        }
    }


</script>
<script src="../../t_js/vue.js"></script>
<script src="../../t_js/axios.js"></script>
<!--<script src="../../js/util.js"></script>-->
<!--<script src="../../js/elementui.js"></script>-->
<script src="../../t_js/util.js"></script>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                tableData: [],
                enter: [],
                user: {},
                basics: [],
                team: [],
                teachers: [],
                len: "",
                len2: "",
                times: "",
                tid: null,
                currentPage: 1,
                total: 10,
                size: 10,
                searchMap: {},
                pojo: {},
                formVisible: false,
                imageUrl: ''
            }
        },
        created() {
            this.tid = getQueryString("tid")

            this.searchMap = {tid: getQueryString("tid")}
            this.fetchData();
        },
        methods: {
            fetchData() {
                axios.post(`/tableEnter/findList.do`, this.searchMap).then(response => {
                    this.enter = response.data[0];
                });
                axios.post(`/userTeam/findList.do`, this.searchMap).then(response => {
                    this.user = response.data[0];
                    console.log(this.user)
                });
                axios.post(`/basicInfor/findList.do`, this.searchMap).then(response => {
                    // response.date[0].regTime=new Date(response.date[0].regTime).format("yyyy-MM-dd");
                    this.basics = response.data;
                    // console.log(this.basics)
                });
                axios.post(`/teammate/findList.do`, this.searchMap).then(response => {
                    this.team = response.data;
                    if (this.team.length <= 0 || this.team.length == "") {
                        this.team.content = "";
                    }
                    this.len2 = this.team.length + 1;
                });
                axios.post(`/teacher/findList.do`, this.searchMap).then(response => {
                    this.teachers = response.data;
                    if (this.teachers.length <= 0 || this.teachers.length == "") {
                        // this.teachers[0].id = "1";
                        this.teachers[0] = {phone: ""};
                        this.teachers[0] = {department: ""};
                        this.teachers[0] = {position: ""};
                        this.teachers[0] = {field: ""};
                    }
                    if (this.teachers.length > 1) {
                        this.len = this.teachers.length * 2 + this.teachers.length;
                    } else {
                        this.len = this.teachers.length * 2;
                    }

                    // $('#th1').css('rowspan', "2");
                });

            },
            subTable() {
                this.user.isSub = 1;
                // this.pojo={"tid":this.user.tid}
                axios.post(`/userTeam/update.do`, this.user).then(response => {
                    // // this.user = response.data[0];
                    // console.log(response.data);
                    // console.log(this.user);
                    var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                    parent.layer.close(index); //再执行关闭

                });
            },
            /* ****图片上传相关代码  如页面有图片上传功能放开注释 ****
            handleAvatarSuccess(res, file) {
                this.imageUrl = file.response;
            },
            beforeAvatarUpload(file) {
                const isJPG = file.type === 'image/jpeg';
                const isLt2M = file.size / 1024 / 1024 < 2;

                if (!isJPG) {
                    this.$message.error('上传头像图片只能是 JPG 格式!');
                }
                if (!isLt2M) {
                    this.$message.error('上传头像图片大小不能超过 2MB!');
                }
                return isJPG && isLt2M;
            }*/
        }
    })
</script>
<script>
    function back() {
        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        parent.layer.close(index); //再执行关闭
    }

    //
    function sub(obj, id, name) {
        layer.confirm('确认提交吗？', {icon: 3, title: "是否确认提交？"}, function (index) {
            $.get("__CONTROLLER__/Isub", {sid: id}, function (msg) {
                if (msg.flag === true) {
                    layer.msg('已提交!', {icon: 1, time: 1000, title: "确认"});
                    var t = setTimeout("window.parent.location.reload();", 1000);

                } else {
                    alert(msg.msg);
                }
            }, "json");
        });
    }

    //打印
    function print() {
        $("#print-area").jqprint({
            debug: false,
            importCSS: true,
            printContainer: true,
            operaSupport: false
        });
    }

    $(function () {
        if ($('#registered').text() == '否') {
            $('#reg_time').text('无');
            $('#money').text('无');
        }
    });
</script>
